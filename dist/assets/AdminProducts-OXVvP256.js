import{c as p,r as i,j as e,m as H,X as F}from"./index-nUOwSlA7.js";import{C as V}from"./circle-alert-BVnQbfbR.js";import{C as K}from"./circle-check-big-BL7ehH5A.js";import{P as M}from"./package-DYF3UGhz.js";import{S as J}from"./save-7CCknx8n.js";import{T as W}from"./trash-2-qE4noPED.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],$=p("loader-circle",X);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],N=p("plus",G);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],Z=p("square-pen",Y);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]],te=p("table",ee);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]],ae=p("trash",se);function me(){console.log("API_BASE:","");const[k,B]=i.useState([]),[Q,w]=i.useState(!0),[S,c]=i.useState(null),[A,P]=i.useState(null),[b,C]=i.useState(!1),[u,I]=i.useState(null),[E,f]=i.useState(!1),[ne,oe]=i.useState(!1),[m,g]=i.useState([{key:"",value:""}]),[r,l]=i.useState({name:"",brand:"",price:"",images:[""],description:"",category:"",rating:"4.5",inStock:!0,stockQuantity:""});i.useEffect(()=>{y()},[]);const y=async()=>{c(null),w(!0);try{const t=localStorage.getItem("token"),s=new AbortController,n=setTimeout(()=>s.abort(),1e4),a=await fetch("/products",{headers:t?{Authorization:`Bearer ${t}`}:void 0,signal:s.signal});if(clearTimeout(n),a.ok){const o=await a.json();B(o)}else a.status===401?c("Session expired. Please log in again."):a.status===500||!a.ok?c("Unable to connect to server. Please ensure the backend is running."):c("Failed to load products")}catch(t){t.name==="AbortError"?c("Request timed out. Server may be unreachable."):t.message==="Failed to fetch"||t.message.includes("fetch")?c("Unable to connect to server. Please check that the backend is running on http://localhost:5000"):(console.error("Failed to fetch products:",t),c("Failed to load products: "+t.message))}finally{w(!1)}},T=t=>{if(!t)return[{key:"",value:""}];const s=t.split(`
`),n=[];return s.forEach(a=>{if(a.includes(":")){const o=a.indexOf(":"),x=a.substring(0,o),d=a.substring(o+1);(x.trim()||d.trim())&&n.push({key:x.trim(),value:d.trim()})}else if(a.includes("-")&&!a.startsWith("-")){const o=a.indexOf("-"),x=a.substring(0,o),d=a.substring(o+1);(x.trim()||d.trim())&&n.push({key:x.trim(),value:d.trim()})}else a.trim()&&n.push({key:"",value:a.trim()})}),n.length>0?n:[{key:"",value:""}]},R=t=>t.filter(s=>s.key||s.value).map(s=>`${s.key}: ${s.value}`).join(`
`),q=async t=>{t.preventDefault(),C(!0),c(null),P(null);const s=R(m),n=r.stockQuantity?parseInt(r.stockQuantity):null,a={...r,price:parseFloat(r.price),rating:parseFloat(r.rating),specs:s,stockQuantity:n};console.log("Submitting product data:",a);try{const o=u?`/products/${u._id}`:"/products",x=u?"PUT":"POST",d=localStorage.getItem("token");if(console.log("Submitting to:",o,"Method:",x),console.log("Token present:",!!d),!d)throw new Error("Authentication required. Please log in as an admin.");const v=await fetch(o,{method:x,headers:{"Content-Type":"application/json",Authorization:`Bearer ${d}`},body:JSON.stringify(a)}),z=await v.json();if(console.log("Response:",v.status,z),v.ok){const h=u?"Product updated successfully!":`Product "${r.name}" created successfully!`;P(h),console.log("Product saved successfully:",h),y(),j()}else{const h=z.message||`Failed to ${u?"update":"create"} product`;c(h),console.error("Error saving product:",h)}}catch(o){console.error("Failed to save product:",o),c(o.message||"Failed to save product. Please check your connection and try again.")}finally{C(!1)}},L=async t=>{if(confirm("Are you sure you want to delete this product?"))try{const s=localStorage.getItem("token");(await fetch(`/products/${t}`,{method:"DELETE",headers:s?{Authorization:`Bearer ${s}`}:void 0})).ok?y():c("Failed to delete product")}catch(s){console.error("Failed to delete product:",s),c("Failed to delete product")}},j=()=>{l({name:"",brand:"",price:"",images:[""],description:"",category:"",rating:"4.5",inStock:!0,stockQuantity:""}),g([{key:"",value:""}]),I(null),f(!1)},D=t=>{var s;I(t),l({name:t.name,brand:t.brand||"",price:t.price.toString(),images:t.images||[""],description:t.description||"",category:t.category,rating:t.rating.toString(),inStock:t.inStock,stockQuantity:((s=t.stockQuantity)==null?void 0:s.toString())||""}),g(T(t.specs)),f(!0)},O=()=>{g([...m,{key:"",value:""}])},U=t=>{if(m.length>1){const s=m.filter((n,a)=>a!==t);g(s)}},_=(t,s,n)=>{const a=[...m];a[t]={...a[t],[s]:n},g(a)};return Q?e.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center",children:e.jsx("div",{className:"text-cyan-400",children:"Loading products..."})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-b from-black via-gray-900 to-black p-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Product Management"}),e.jsxs("button",{onClick:()=>f(!E),className:"flex items-center space-x-2 px-6 py-3 bg-gradient-to-r from-cyan-500 to-blue-600 text-white rounded-lg hover:from-cyan-600 hover:to-blue-700 transition-all",children:[e.jsx(N,{size:20}),e.jsx("span",{children:"Add Product"})]})]}),S&&e.jsxs("div",{className:"mb-4 px-4 py-3 rounded-lg border border-red-500/40 bg-red-500/10 text-red-200 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(V,{size:18}),e.jsx("span",{children:S})]}),e.jsxs("button",{onClick:()=>{c(null),y()},className:"px-3 py-1 bg-red-600/30 hover:bg-red-600/50 text-red-200 rounded-lg transition-colors text-sm flex items-center space-x-1",children:[e.jsx($,{size:14}),e.jsx("span",{children:"Retry"})]})]}),A&&e.jsxs("div",{className:"mb-4 px-4 py-3 rounded-lg border border-green-500/40 bg-green-500/10 text-green-200 flex items-center space-x-2",children:[e.jsx(K,{size:18}),e.jsx("span",{children:A})]}),E&&e.jsxs(H.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-gradient-to-br from-gray-900 to-black border border-cyan-500/30 rounded-xl p-6 mb-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:u?"Edit Product":"Add New Product"}),e.jsx("button",{onClick:j,className:"text-gray-400 hover:text-white transition-colors",children:e.jsx(F,{size:24})})]}),e.jsxs("form",{onSubmit:q,className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Product Name"}),e.jsx("input",{type:"text",value:r.name,onChange:t=>l({...r,name:t.target.value}),className:"w-full px-4 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white focus:border-cyan-500 focus:outline-none",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Brand"}),e.jsx("input",{type:"text",value:r.brand,onChange:t=>l({...r,brand:t.target.value}),className:"w-full px-4 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white focus:border-cyan-500 focus:outline-none",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Price (₹)"}),e.jsx("input",{type:"number",step:"0.01",value:r.price,onChange:t=>l({...r,price:t.target.value}),className:"w-full px-4 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white focus:border-cyan-500 focus:outline-none",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Category"}),e.jsxs("select",{value:r.category,onChange:t=>l({...r,category:t.target.value}),className:"w-full px-4 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white focus:border-cyan-500 focus:outline-none",required:!0,children:[e.jsx("option",{value:"",children:"Select Category"}),e.jsx("option",{value:"Mice",children:"Mice"}),e.jsx("option",{value:"Keyboards",children:"Keyboards"}),e.jsx("option",{value:"Headsets",children:"Headsets"}),e.jsx("option",{value:"Monitors",children:"Monitors"}),e.jsx("option",{value:"Accessories",children:"Accessories"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Product Images"}),r.images.map((t,s)=>e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("input",{type:"url",value:t,onChange:n=>{const a=[...r.images];a[s]=n.target.value,l({...r,images:a})},className:"flex-1 px-4 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white focus:border-cyan-500 focus:outline-none",placeholder:"Enter image URL",required:s===0}),r.images.length>1&&e.jsx("button",{type:"button",onClick:()=>{const n=r.images.filter((a,o)=>o!==s);l({...r,images:n})},className:"px-3 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:e.jsx(F,{size:16})})]},s)),e.jsxs("button",{type:"button",onClick:()=>l({...r,images:[...r.images,""]}),className:"flex items-center space-x-2 px-4 py-2 bg-gray-700 text-gray-300 rounded-lg hover:bg-gray-600 transition-colors",children:[e.jsx(N,{size:16}),e.jsx("span",{children:"Add Another Image"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Description"}),e.jsx("textarea",{value:r.description,onChange:t=>l({...r,description:t.target.value}),rows:3,className:"w-full px-4 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white focus:border-cyan-500 focus:outline-none"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(te,{size:16}),e.jsx("span",{children:"Specifications"})]})}),e.jsxs("div",{className:"bg-gray-800/50 rounded-lg overflow-hidden border border-gray-600",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-700/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Specification"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Value"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase w-16",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700",children:m.map((t,s)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 py-2",children:e.jsx("input",{type:"text",value:t.key,onChange:n=>_(s,"key",n.target.value),placeholder:"e.g., Sensor",className:"w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white text-sm focus:border-cyan-500 focus:outline-none"})}),e.jsx("td",{className:"px-2 py-2",children:e.jsx("input",{type:"text",value:t.value,onChange:n=>_(s,"value",n.target.value),placeholder:"e.g., Optical",className:"w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white text-sm focus:border-cyan-500 focus:outline-none"})}),e.jsx("td",{className:"px-2 py-2",children:e.jsx("button",{type:"button",onClick:()=>U(s),disabled:m.length===1,className:"p-2 bg-red-600/20 text-red-400 rounded-lg hover:bg-red-600/30 transition-colors disabled:opacity-30 disabled:cursor-not-allowed",children:e.jsx(ae,{size:16})})})]},s))})]}),e.jsx("div",{className:"p-3 border-t border-gray-700",children:e.jsxs("button",{type:"button",onClick:O,className:"flex items-center gap-2 px-4 py-2 bg-cyan-600/20 text-cyan-400 rounded-lg hover:bg-cyan-600/30 transition-colors text-sm",children:[e.jsx(N,{size:16}),"Add Specification"]})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{size:16}),e.jsx("span",{children:"Stock Quantity"})]})}),e.jsx("input",{type:"number",min:"0",value:r.stockQuantity,onChange:t=>l({...r,stockQuantity:t.target.value}),placeholder:"Leave empty for unlimited",className:"w-full px-4 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white focus:border-cyan-500 focus:outline-none"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Leave empty to not show stock count to customers"})]}),e.jsx("div",{className:"flex items-center",children:e.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r.inStock,onChange:t=>l({...r,inStock:t.target.checked}),className:"w-5 h-5 rounded border-gray-600 text-cyan-500 focus:ring-cyan-500 bg-gray-800"}),e.jsx("span",{className:"text-gray-300",children:"Product is in stock"})]})}),e.jsxs("div",{className:"md:col-span-2 flex justify-end space-x-4 pt-4",children:[e.jsx("button",{type:"button",onClick:j,disabled:b,className:"px-6 py-2 border border-gray-600 text-gray-300 rounded-lg hover:bg-gray-800 transition-colors disabled:opacity-50",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:b,className:"flex items-center space-x-2 px-6 py-2 bg-gradient-to-r from-cyan-500 to-blue-600 text-white rounded-lg hover:from-cyan-600 hover:to-blue-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:b?e.jsxs(e.Fragment,{children:[e.jsx($,{size:18,className:"animate-spin"}),e.jsx("span",{children:"Saving..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(J,{size:18}),e.jsx("span",{children:u?"Update Product":"Create Product"})]})})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-cyan-500/30 rounded-xl overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-800/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Product"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Brand"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Price"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Stock"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700",children:k.map(t=>{var s;return e.jsxs("tr",{className:"hover:bg-gray-800/30 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-12 w-12",children:e.jsx("img",{className:"h-12 w-12 rounded-lg object-cover",src:((s=t.images)==null?void 0:s[0])||"",alt:t.name})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-white",children:t.name}),e.jsx("div",{className:"text-sm text-gray-400 truncate max-w-xs",children:t.category})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:t.brand||"N/A"}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-cyan-400",children:["₹",t.price]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full w-fit ${t.inStock?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t.inStock?"In Stock":"Out of Stock"}),t.inStock&&t.stockQuantity!==null&&e.jsxs("span",{className:"text-xs text-gray-500 mt-1",children:[t.stockQuantity," units"]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>D(t),className:"text-cyan-400 hover:text-cyan-300 transition-colors",children:e.jsx(Z,{size:18})}),e.jsx("button",{onClick:()=>L(t._id),className:"text-red-400 hover:text-red-300 transition-colors",children:e.jsx(W,{size:18})})]})})]},t._id)})})]})}),k.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(M,{size:48,className:"mx-auto text-gray-600 mb-4"}),e.jsx("p",{className:"text-gray-400",children:"No products found. Add your first product to get started."})]})]})]})})}export{me as AdminProducts,me as default};
