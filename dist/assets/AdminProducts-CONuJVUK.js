var G=Object.defineProperty,Y=Object.defineProperties;var Z=Object.getOwnPropertyDescriptors;var R=Object.getOwnPropertySymbols;var ee=Object.prototype.hasOwnProperty,te=Object.prototype.propertyIsEnumerable;var q=(u,o,c)=>o in u?G(u,o,{enumerable:!0,configurable:!0,writable:!0,value:c}):u[o]=c,d=(u,o)=>{for(var c in o||(o={}))ee.call(o,c)&&q(u,c,o[c]);if(R)for(var c of R(o))te.call(o,c)&&q(u,c,o[c]);return u},x=(u,o)=>Y(u,Z(o));var C=(u,o,c)=>new Promise((I,N)=>{var A=p=>{try{v(c.next(p))}catch(b){N(b)}},i=p=>{try{v(c.throw(p))}catch(b){N(b)}},v=p=>p.done?I(p.value):Promise.resolve(p.value).then(A,i);v((c=c.apply(u,o)).next())});import{c as S,j as e,m as se,X as L}from"./index-8I7Fa53G.js";import{b as g}from"./react-router-D18IwnqA.js";import{C as ae}from"./circle-alert-C1qTISOf.js";import{C as re}from"./circle-check-big-701bdidE.js";import{P as D}from"./package-Cs1Zgwn1.js";import{S as ne}from"./save-BntE1KRg.js";import{T as oe}from"./trash-2-BQLZ1mXj.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],O=S("loader-circle",ce);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],F=S("plus",le);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],de=S("square-pen",ie);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]],ue=S("table",xe);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]],ge=S("trash",me);function Se(){console.log("API_BASE:","");const[o,c]=g.useState([]),[I,N]=g.useState(!0),[A,i]=g.useState(null),[v,p]=g.useState(null),[b,M]=g.useState(!1),[f,$]=g.useState(null),[B,E]=g.useState(!1),[pe,he]=g.useState(!1),[j,k]=g.useState([{key:"",value:""}]),[r,m]=g.useState({name:"",brand:"",price:"",images:[""],description:"",category:"",rating:"4.5",inStock:!0,stockQuantity:""});g.useEffect(()=>{P()},[]);const P=()=>C(null,null,function*(){i(null),N(!0);try{const t=localStorage.getItem("token"),s=new AbortController,n=setTimeout(()=>s.abort(),1e4),a=yield fetch("/products",{headers:t?{Authorization:`Bearer ${t}`}:void 0,signal:s.signal});if(clearTimeout(n),a.ok){const l=yield a.json(),h=Array.isArray(l)?l:l.products||[];c(h)}else a.status===401?i("Session expired. Please log in again."):a.status===500||!a.ok?i("Unable to connect to server. Please ensure the backend is running."):i("Failed to load products")}catch(t){t.name==="AbortError"?i("Request timed out. Server may be unreachable."):t.message==="Failed to fetch"||t.message.includes("fetch")?i("Unable to connect to server. Please check that the backend is running on http://localhost:5000"):(console.error("Failed to fetch products:",t),i("Failed to load products: "+t.message))}finally{N(!1)}}),U=t=>{if(!t)return[{key:"",value:""}];const s=t.split(`
`),n=[];return s.forEach(a=>{if(a.includes(":")){const l=a.indexOf(":"),h=a.substring(0,l),y=a.substring(l+1);(h.trim()||y.trim())&&n.push({key:h.trim(),value:y.trim()})}else if(a.includes("-")&&!a.startsWith("-")){const l=a.indexOf("-"),h=a.substring(0,l),y=a.substring(l+1);(h.trim()||y.trim())&&n.push({key:h.trim(),value:y.trim()})}else a.trim()&&n.push({key:"",value:a.trim()})}),n.length>0?n:[{key:"",value:""}]},H=t=>t.filter(s=>s.key||s.value).map(s=>`${s.key}: ${s.value}`).join(`
`),V=t=>C(null,null,function*(){t.preventDefault(),M(!0),i(null),p(null);const s=H(j),n=r.stockQuantity?parseInt(r.stockQuantity):null,a=x(d({},r),{price:parseFloat(r.price),rating:parseFloat(r.rating),specs:s,stockQuantity:n});console.log("Submitting product data:",a);try{const l=f?`/products/${f._id}`:"/products",h=f?"PUT":"POST",y=localStorage.getItem("token");if(console.log("Submitting to:",l,"Method:",h),console.log("Token present:",!!y),!y)throw new Error("Authentication required. Please log in as an admin.");const z=yield fetch(l,{method:h,headers:{"Content-Type":"application/json",Authorization:`Bearer ${y}`},body:JSON.stringify(a)}),T=yield z.json();if(console.log("Response:",z.status,T),z.ok){const w=f?"Product updated successfully!":`Product "${r.name}" created successfully!`;p(w),console.log("Product saved successfully:",w),P(),_()}else{const w=T.message||`Failed to ${f?"update":"create"} product`;i(w),console.error("Error saving product:",w)}}catch(l){console.error("Failed to save product:",l),i(l.message||"Failed to save product. Please check your connection and try again.")}finally{M(!1)}}),K=t=>C(null,null,function*(){if(confirm("Are you sure you want to delete this product?"))try{const s=localStorage.getItem("token");(yield fetch(`/products/${t}`,{method:"DELETE",headers:s?{Authorization:`Bearer ${s}`}:void 0})).ok?P():i("Failed to delete product")}catch(s){console.error("Failed to delete product:",s),i("Failed to delete product")}}),_=()=>{m({name:"",brand:"",price:"",images:[""],description:"",category:"",rating:"4.5",inStock:!0,stockQuantity:""}),k([{key:"",value:""}]),$(null),E(!1)},J=t=>{var s;$(t),m({name:t.name,brand:t.brand||"",price:t.price.toString(),images:t.images||[""],description:t.description||"",category:t.category,rating:t.rating.toString(),inStock:t.inStock,stockQuantity:((s=t.stockQuantity)==null?void 0:s.toString())||""}),k(U(t.specs)),E(!0)},W=()=>{k([...j,{key:"",value:""}])},X=t=>{if(j.length>1){const s=j.filter((n,a)=>a!==t);k(s)}},Q=(t,s,n)=>{const a=[...j];a[t]=x(d({},a[t]),{[s]:n}),k(a)};return I?e.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center",children:e.jsx("div",{className:"text-cyan-400",children:"Loading products..."})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-b from-black via-gray-900 to-black p-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Product Management"}),e.jsxs("button",{onClick:()=>E(!B),className:"flex items-center space-x-2 px-6 py-3 bg-gradient-to-r from-cyan-500 to-blue-600 text-white rounded-lg hover:from-cyan-600 hover:to-blue-700 transition-all",children:[e.jsx(F,{size:20}),e.jsx("span",{children:"Add Product"})]})]}),A&&e.jsxs("div",{className:"mb-4 px-4 py-3 rounded-lg border border-red-500/40 bg-red-500/10 text-red-200 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ae,{size:18}),e.jsx("span",{children:A})]}),e.jsxs("button",{onClick:()=>{i(null),P()},className:"px-3 py-1 bg-red-600/30 hover:bg-red-600/50 text-red-200 rounded-lg transition-colors text-sm flex items-center space-x-1",children:[e.jsx(O,{size:14}),e.jsx("span",{children:"Retry"})]})]}),v&&e.jsxs("div",{className:"mb-4 px-4 py-3 rounded-lg border border-green-500/40 bg-green-500/10 text-green-200 flex items-center space-x-2",children:[e.jsx(re,{size:18}),e.jsx("span",{children:v})]}),B&&e.jsxs(se.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-gradient-to-br from-gray-900 to-black border border-cyan-500/30 rounded-xl p-6 mb-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:f?"Edit Product":"Add New Product"}),e.jsx("button",{onClick:_,className:"text-gray-400 hover:text-white transition-colors",children:e.jsx(L,{size:24})})]}),e.jsxs("form",{onSubmit:V,className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Product Name"}),e.jsx("input",{type:"text",value:r.name,onChange:t=>m(x(d({},r),{name:t.target.value})),className:"w-full px-4 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white focus:border-cyan-500 focus:outline-none",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Brand"}),e.jsx("input",{type:"text",value:r.brand,onChange:t=>m(x(d({},r),{brand:t.target.value})),className:"w-full px-4 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white focus:border-cyan-500 focus:outline-none",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Price (₹)"}),e.jsx("input",{type:"number",step:"0.01",value:r.price,onChange:t=>m(x(d({},r),{price:t.target.value})),className:"w-full px-4 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white focus:border-cyan-500 focus:outline-none",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Category"}),e.jsxs("select",{value:r.category,onChange:t=>m(x(d({},r),{category:t.target.value})),className:"w-full px-4 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white focus:border-cyan-500 focus:outline-none",required:!0,children:[e.jsx("option",{value:"",children:"Select Category"}),e.jsx("option",{value:"Mice",children:"Mice"}),e.jsx("option",{value:"Keyboards",children:"Keyboards"}),e.jsx("option",{value:"Headsets",children:"Headsets"}),e.jsx("option",{value:"Monitors",children:"Monitors"}),e.jsx("option",{value:"Accessories",children:"Accessories"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Product Images"}),r.images.map((t,s)=>e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("input",{type:"url",value:t,onChange:n=>{const a=[...r.images];a[s]=n.target.value,m(x(d({},r),{images:a}))},className:"flex-1 px-4 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white focus:border-cyan-500 focus:outline-none",placeholder:"Enter image URL",required:s===0}),r.images.length>1&&e.jsx("button",{type:"button",onClick:()=>{const n=r.images.filter((a,l)=>l!==s);m(x(d({},r),{images:n}))},className:"px-3 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:e.jsx(L,{size:16})})]},s)),e.jsxs("button",{type:"button",onClick:()=>m(x(d({},r),{images:[...r.images,""]})),className:"flex items-center space-x-2 px-4 py-2 bg-gray-700 text-gray-300 rounded-lg hover:bg-gray-600 transition-colors",children:[e.jsx(F,{size:16}),e.jsx("span",{children:"Add Another Image"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Description"}),e.jsx("textarea",{value:r.description,onChange:t=>m(x(d({},r),{description:t.target.value})),rows:3,className:"w-full px-4 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white focus:border-cyan-500 focus:outline-none"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ue,{size:16}),e.jsx("span",{children:"Specifications"})]})}),e.jsxs("div",{className:"bg-gray-800/50 rounded-lg overflow-hidden border border-gray-600",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-700/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Specification"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase",children:"Value"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-300 uppercase w-16",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700",children:j.map((t,s)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 py-2",children:e.jsx("input",{type:"text",value:t.key,onChange:n=>Q(s,"key",n.target.value),placeholder:"e.g., Sensor",className:"w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white text-sm focus:border-cyan-500 focus:outline-none"})}),e.jsx("td",{className:"px-2 py-2",children:e.jsx("input",{type:"text",value:t.value,onChange:n=>Q(s,"value",n.target.value),placeholder:"e.g., Optical",className:"w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white text-sm focus:border-cyan-500 focus:outline-none"})}),e.jsx("td",{className:"px-2 py-2",children:e.jsx("button",{type:"button",onClick:()=>X(s),disabled:j.length===1,className:"p-2 bg-red-600/20 text-red-400 rounded-lg hover:bg-red-600/30 transition-colors disabled:opacity-30 disabled:cursor-not-allowed",children:e.jsx(ge,{size:16})})})]},s))})]}),e.jsx("div",{className:"p-3 border-t border-gray-700",children:e.jsxs("button",{type:"button",onClick:W,className:"flex items-center gap-2 px-4 py-2 bg-cyan-600/20 text-cyan-400 rounded-lg hover:bg-cyan-600/30 transition-colors text-sm",children:[e.jsx(F,{size:16}),"Add Specification"]})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{size:16}),e.jsx("span",{children:"Stock Quantity"})]})}),e.jsx("input",{type:"number",min:"0",value:r.stockQuantity,onChange:t=>m(x(d({},r),{stockQuantity:t.target.value})),placeholder:"Leave empty for unlimited",className:"w-full px-4 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white focus:border-cyan-500 focus:outline-none"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Leave empty to not show stock count to customers"})]}),e.jsx("div",{className:"flex items-center",children:e.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r.inStock,onChange:t=>m(x(d({},r),{inStock:t.target.checked})),className:"w-5 h-5 rounded border-gray-600 text-cyan-500 focus:ring-cyan-500 bg-gray-800"}),e.jsx("span",{className:"text-gray-300",children:"Product is in stock"})]})}),e.jsxs("div",{className:"md:col-span-2 flex justify-end space-x-4 pt-4",children:[e.jsx("button",{type:"button",onClick:_,disabled:b,className:"px-6 py-2 border border-gray-600 text-gray-300 rounded-lg hover:bg-gray-800 transition-colors disabled:opacity-50",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:b,className:"flex items-center space-x-2 px-6 py-2 bg-gradient-to-r from-cyan-500 to-blue-600 text-white rounded-lg hover:from-cyan-600 hover:to-blue-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:b?e.jsxs(e.Fragment,{children:[e.jsx(O,{size:18,className:"animate-spin"}),e.jsx("span",{children:"Saving..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(ne,{size:18}),e.jsx("span",{children:f?"Update Product":"Create Product"})]})})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-cyan-500/30 rounded-xl overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-800/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Product"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Brand"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Price"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Stock"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700",children:o.map(t=>{var s;return e.jsxs("tr",{className:"hover:bg-gray-800/30 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-12 w-12",children:e.jsx("img",{className:"h-12 w-12 rounded-lg object-cover",src:((s=t.images)==null?void 0:s[0])||"",alt:t.name})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-white",children:t.name}),e.jsx("div",{className:"text-sm text-gray-400 truncate max-w-xs",children:t.category})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:t.brand||"N/A"}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-cyan-400",children:["₹",t.price]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full w-fit ${t.inStock?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t.inStock?"In Stock":"Out of Stock"}),t.inStock&&t.stockQuantity!==null&&e.jsxs("span",{className:"text-xs text-gray-500 mt-1",children:[t.stockQuantity," units"]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>J(t),className:"text-cyan-400 hover:text-cyan-300 transition-colors",children:e.jsx(de,{size:18})}),e.jsx("button",{onClick:()=>K(t._id),className:"text-red-400 hover:text-red-300 transition-colors",children:e.jsx(oe,{size:18})})]})})]},t._id)})})]})}),o.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(D,{size:48,className:"mx-auto text-gray-600 mb-4"}),e.jsx("p",{className:"text-gray-400",children:"No products found. Add your first product to get started."})]})]})]})})}export{Se as AdminProducts,Se as default};
